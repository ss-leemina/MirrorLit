<div class="article">
  <button class="list-button">
    <a href="/articles">Î™©Î°ù Î≥¥Í∏∞</a>
  </button>
  <div class="meta">
    <%= article.press %> ¬∑
      <%= new Date(article.created_at).toLocaleString('ko-KR') %>
  </div>

  <h1>
    <%= article.title %>
  </h1>

  <div class="author">
    <%= article.author %> Í∏∞Ïûê
  </div>
  <hr>

  <div class="content">
    <% if (article.articleImage && article.articleImage.image_url) { %>
      <img src="<%= article.articleImage.image_url %>" alt="ÎåÄÌëú Ïù¥ÎØ∏ÏßÄ">
      <% } %>
        <p>
          <%- article.content.replace(/\n/g, '<br>' ) %>
        </p>
  </div>

  <!-- Ìå©Ìä∏Ï≤¥ÌÅ¨ Î≤ÑÌäº -->
  <form class="factCheck" method="POST" action="/articles/<%= article.article_id %>/factcheck">
    <button class="factCheck-Yes" name="factCheck_type" value="fact" type="submit">Ìå©Ìä∏Îã§ <%= factCounts.fact %></button>
    <button class="factCheck-No" name="factCheck_type" value="nofact" type="submit">ÏïÑÎãàÎã§ <%= factCounts.nofact %>
    </button>
  </form>
  <hr>

  <div>
    <!-- ÎåìÍ∏Ä ÏûëÏÑ± -->
    <form class="comment-form" method="POST" action="/comments">
      <h2>ÎåìÍ∏Ä <%=commentCounts %>
      </h2>
      <input type="hidden" name="article_id" value="<%= article.article_id %>">
      <input type="url" name="source" placeholder="Ï∂úÏ≤ò" required>
      <textarea name="content" placeholder="ÎåìÍ∏ÄÏùÑ ÏûëÏÑ±ÌïòÎ†§Î©¥ Î°úÍ∑∏Ïù∏ Ìï¥Ï£ºÏÑ∏Ïöî." required></textarea>
      <button type="submit">ÏûëÏÑ±</button>
    </form>
  </div>

  <div class="comment-section">
    <% if (!comments || comments.length===0) { %>
      <p class="no-comments">ÏïÑÏßÅ ÎåìÍ∏ÄÏù¥ ÏóÜÏäµÎãàÎã§.</p>
      <% } else { %>
        <% comments.forEach(comment=> { %>
          <div class="comment-card">
            <!-- ÏÇ≠Ï†ú Î≤ÑÌäº -->
            <form method="POST" action="/comments/<%= comment.comment_id %>/delete">
              <input type="hidden" name="article_id" value="<%= article.article_id %>">
              <button type="submit" class="delete-button">‚ùå</button>
            </form>

            <p class="comment-author">
              <%= comment.user.name %> „Äå<%= comment.user.user_rank.rank_name %>„Äç
            </p>
            <p class="comment-source">Ï∂úÏ≤ò : <%= comment.source %>
            </p>
            <p class="comment-content">
              <%= comment.content %>
            </p>
            <br>
            <p class="comment-date ">
              <%= new Date(comment.created_at).toLocaleString('ko-KR') %>
            </p>

            <div class="reaction-buttons">
              <!-- Ï∂îÏ≤ú Î≤ÑÌäº (üëç) -->
              <form method="POST" action="/comments/<%= comment.comment_id %>/reaction">
                <input type="hidden" name="reaction_type" value="like">
                <% if (loggedIn) { %>
                  <input type="hidden" name="user_id" value="<%= currentUser.user_id %>">
                  <% } %>
                    <input type="hidden" name="article_id" value="<%= article.article_id %>">
                    <button type="submit">üëç Ï∂îÏ≤ú</button>
              </form>

              <!-- ÎπÑÏ∂îÏ≤ú Î≤ÑÌäº (üëé) -->
              <form method="POST" action="/comments/<%= comment.comment_id %>/reaction">
                <input type="hidden" name="reaction_type" value="dislike">
                <% if (loggedIn) { %>
                  <input type="hidden" name="user_id" value="<%= currentUser.user_id %>">
                  <% } %>
                    <input type="hidden" name="article_id" value="<%= article.article_id %>">
                    <button type="submit">üëé ÎπÑÏ∂îÏ≤ú</button>
              </form>
            </div>
          </div>
          <% }) %>
            <% } %>
  </div>

  <!-- flash Î©îÏÑ∏ÏßÄ Ï∂îÍ∞Ä -->
  <% if (flashMessages) { %>
    <% if (flashMessages.selected) { %>
      <script>
        alert("<%= flashMessages.selected %>");
      </script>
      <% } %>
        <% if (flashMessages.notLogin) { %>
          <script>
            alert("<%= flashMessages.notLogin %>");
          </script>
          <% } %>
            <% if (flashMessages.noUser) { %>
              <script>
                alert("<%= flashMessages.noUser %>");
              </script>
              <% } %>
                <% if (flashMessages.reactionselected){ %>
                  <script>
                    alert("<%= flashMessages.reactionselected %>");
                  </script>
                  <% } %>
                    <% if (flashMessages.reactionerror) { %>
                      <script>
                        alert("<%= flashMessages.reactionerror %>");
                      </script>
                      <% } %>
                        <% if (flashMessages.avaliablefactcheck) { %>
                          <script>
                            alert("<%= flashMessages.avaliablefactcheck %>");
                          </script>
                          <% } %>
                            <% } %>

</div>